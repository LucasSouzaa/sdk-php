<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>PHP Integration lib by maxipago</title>

    <link rel="stylesheet" href="../stylesheets/styles.css">
    <link rel="stylesheet" href="../stylesheets/pygment_trac.css">
    <script src="../javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Biblioteca de integração PHP</h1>
        <p>maxiPago! Smart Payments - Lib PHP</p>
        <p class="view"><a href="https://github.com/maxipago/PHP-Integration-lib">Ver Projeto no GitHub <small>maxipago/PHP-Integration-lib</small></a></p>
        <ul>
          <li><a href="https://github.com/maxipago/PHP-Integration-lib/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/maxipago/PHP-Integration-lib/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/maxipago/PHP-Integration-lib">Ver No <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
<p align="right"><small><strong>For English <a href="../">click here</a>.</small></strong></p>
        <h2>Índice</h2>

<ol>
<li><a href="#intro">Introdução</a></li>
<li><a href="#types">Tipos de Transação</a></li>
<li><a href="#setup">Instalação e configuração</a></li>
<li><a href="#credentials">Ambiente e Credenciais</a></li>
<li><a href="#debug">Modo Debug</a></li>
<li><a href="#request">Enviar uma requisição</a></li>
<li><a href="#response">Receber uma resposta</a></li>
<li><a href="#allreq">Todas as requisições</a></li>
<li><a href="#allres">Todas as respostas</a></li>
<li><a href="#support">Suporte</a></li>
</ol><h2 id="intro">Introdução</h2>

<p>Esta <strong>NOVA</strong> biblioteca <strong>PHP</strong> visa facilitar a integração com a API da <strong>maxiPago! Smart Payments</strong>. Nossa plataforma permite aos lojistas virtuais aceitarem pagamentos em diversos países da América Latina e nos EUA e inclui funcionalidades como Cobrança Recorrente Automática, Pagamentos com 1-Clique, Estornos Online, Conciliação de Cartões de Crédito e Ferramentas Anti-Fraude. Se quiser saber mais sobre a <strong>maxiPago!</strong> visite <a href="http://www.maxipago.com/">www.maxipago.com</a>.</p>

<p>Esta biblioteca traz todas as funcionalidades atualmente disponívels na plataforma e ela pode ser copiada e usada livremente por Lojas e desenvolvedores.</p>

<p>Para ter uma visão mais aprofundada da nossa API baixe nossa documentação, <a href="http://www.maxipago.com/docs/maxiPago_API_Ultima.pdf">disponível aqui</a>. Se você está procurando por uma solução de página hospedada ("hosted payment page"), por favor veja a seção <em><strong>smartPages!</strong></em>.</p>

<h2 id="types">Tipos de Transação</h2>

<ul>
<li><p><strong>Autorização:</strong> verifica se o cartão de crédito usado é válido (número, CVV e data de validade) e se o comprador possui limite suficiente para a compra.</p></li>
<li><p><strong>Captura:</strong> confirma a autorização feita para aquele pedido e completa a transação. Se a transação nunca for capturada o Estabelecimento não receberá o dinheiro e o comprador não será cobrado.</p></li>
</ul><blockquote>
<p><em>Separar a autorização e a captura em dois momentos diferentes é uma ótima maneira de checar se você tem os produtos em estoque ou fazer uma análise de fraude, e ainda assim garantir o pagamento.</em></p>
</blockquote>

<ul>
<li><p><strong>Venda Direta:</strong> combina a autorização e a captura em uma mesma chamada. Ao usar a requisição de Venda Direta você estará fazendo uma autorização no cartão do cliente e imediatamente capturando o valor total.</p></li>
<li><p><strong>Void:</strong>: cancela uma captura antes do fechamento do lote final do dia. Aqui o dinheiro não troca de mãos. Você só pode cancelar a venda até às 23h49 do dia da captura.</p></li>
<li><p><strong>Estorno:</strong> reverte uma transação de cartão de crédito, debitando o valor do Estabelecimento e devolvendo-o ao comprador. O estorno é uma operação financeira e, por esta razão, pode demorar alguns dias para serem aprovados por algumas processadoras.</p></li>
<li><p><strong>Recorrente:</strong> agenda uma transação de cartão de crédito para ser cobrada em um intervalo específico, definido pelo lojista.</p></li>
<li><p><strong>Armazenar Cartão:</strong> guarda um cartão em nosso sistema e devolve um token único, que pode ser usado em novas transações. <strong>Isto permite a implantação de pagamentos com 1-clique no seu site.</strong></p></li>
<li><p><strong>Boleto:</strong> Transações feitas com Boleto funcionam de forma diferente das transações com cartão de crédito. Aqui geramos um boleto e retornamos uma URL para comprador que dá acesso ao boleto. Ela pode ser acessada a qualquer momento antes do vencimento do boleto e até 60 dias após o vencimento.</p></li>
</ul><h2 id="setup">Installation and setup</h2>

<p>A biblioteca consiste dos seguintes arquivos:</p>

<pre><code>  /lib/  
  |-- maxiPago.php  
  |-- maxipago  
    |-- maxiPagoRequest.php  
    |-- maxiPagoRequestBase.php  
    |-- maxiPagoResponseBase.php  
    |-- maxiPagoServiceBase.php  
    |-- maxiPagoTransaction.php  
    |-- maxiPagoXmlHandler.php
</code></pre>

<p>Copie <strong>/lib/maxipago/</strong> para seu servidor. No seu código, inclua o arquivo <strong>maxiPago.php</strong>, que checa os requisitos mínimos e inclui os demais arquivos necessários:</p>

<div class="highlight"><pre>    <span class="k">require_once</span> <span class="s2">"./lib/maxiPago.php"</span><span class="p">;</span>
</pre></div>

<p>Agora, crie um novo object da classe maxiPago:</p>

<div class="highlight"><pre>    <span class="nv">$maxiPago</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">maxiPago</span><span class="p">;</span>
</pre></div>

<h2 id="credentials">Ambiente e Credenciais</h2>

<p>Para poder enviar requisições você precisará de Credenciais válidas. Você pode conseguí-las com nosso Suporte.</p>

<p>A <strong>maxiPago!</strong> oferece um ambiente de teste (*"sandbox"*) totalmente funcional para simular as transações. Você precisa definir o ambiente para enviar as transações, o que pode ser feito enviando <strong>"TEST"</strong> ou <strong>"LIVE"</strong>:</p>

<p>Para definir as credenciais e o ambiente usado:</p>

<div class="highlight"><pre>    <span class="nv">$maxiPago</span><span class="o">-&gt;</span><span class="na">setCredentials</span><span class="p">(</span><span class="s2">"100"</span><span class="p">,</span> <span class="s2">"merchant_key"</span><span class="p">);</span>
    <span class="nv">$maxiPago</span><span class="o">-&gt;</span><span class="na">setEnvironment</span><span class="p">(</span><span class="s2">"TEST"</span><span class="p">);</span>
</pre></div>

<h2 id="debug">Modo Debug</h2>

<p>O Modo Debug imprime os XMLs de requisição e resposta para que você possa facilmente identificar problemas na chamada. Para habilitar o debug use o método <strong>setDebug()</strong>:</p>

<div class="highlight"><pre>    <span class="nv">$maxiPago</span><span class="o">-&gt;</span><span class="na">setDebug</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</pre></div>

<h2 id="request">Enviar uma requisição</h2>

<p>Para mandar uma requisição para a <strong>maxiPago!</strong> você precisa chamar um dos métodos listados abaixo, passando um array com os parâmetros, como por exemplo:</p>

<div class="highlight"><pre>    <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">"processorID"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
        <span class="s2">"referenceNum"</span> <span class="o">=&gt;</span> <span class="s2">"ORDER2937283"</span><span class="p">,</span>
        <span class="s2">"chargeTotal"</span> <span class="o">=&gt;</span> <span class="s2">"10.00"</span><span class="p">,</span>
        <span class="s2">"number"</span> <span class="o">=&gt;</span> <span class="s2">"4111111111111111"</span><span class="p">,</span>
        <span class="s2">"expMonth"</span> <span class="o">=&gt;</span> <span class="s2">"07"</span><span class="p">,</span>
        <span class="s2">"expYear"</span> <span class="o">=&gt;</span> <span class="s2">"2017"</span><span class="p">,</span>
        <span class="s2">"cvvNumber"</span> <span class="o">=&gt;</span> <span class="s2">"123"</span>
    <span class="p">);</span>

    <span class="nv">$maxiPago</span><span class="o">-&gt;</span><span class="na">creditCardAuth</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</pre></div>

<h2 id="response">Receber uma resposta</h2>

<p>Há métodos para resgatar cada parte da resposta. Contudo, você também pode chamar o método <strong>getResponse()</strong> para recuperar todos os campos da resposta em um array:</p>

<pre><code>    print_r($maxiPago-&gt;getResponse());

    Array
    (
        [authCode] =&gt; 123456
        [orderID] =&gt; 0AF90437:013CC42DDE87:F5D0:01E1101A
        [referenceNum] =&gt; ORD29328493
        [transactionID] =&gt; 422570
        [transactionTimestamp] =&gt; 1312156800
        [responseCode] =&gt; 0
        [responseMessage] =&gt; AUTHORIZED
        [avsResponseCode] =&gt;
        [cvvResponseCode] =&gt;
        [processorCode] =&gt; A
        [processorMessage] =&gt; APPROVED
        [errorMessage] =&gt; 
    )
</code></pre>

<h2 id="allreq">Todas as requisições</h2>

<h4>
<a name="transaes-de-carto-de-crdito" class="anchor" href="#transaes-de-carto-de-crdito"><span class="mini-icon mini-icon-link"></span></a>Transações de Cartão de Crédito</h4>

<ul>
<li>Autorização: <strong>creditCardAuth()</strong>
</li>
<li>Captura: <strong>creditCarcCapture()</strong>
</li>
<li>Venda Direta (Autorização + Capura): <strong>creditCardSale()</strong> </li>
<li>Salvar cartão automaticamente: <strong>creditCardAuth()</strong> ou <strong>creditCardSale()</strong>
</li>
<li>Cancelamento (*Void*): <strong>creditCardVoid()</strong>
</li>
<li>Estorno: <strong>creditCardRefund()</strong> </li>
</ul><h4>
<a name="transaes-recorrentes" class="anchor" href="#transaes-recorrentes"><span class="mini-icon mini-icon-link"></span></a>Transações Recorrentes</h4>

<ul>
<li>Criar nova recorrência: <strong>createRecurring()</strong>
</li>
<li>Cancelar uma recorrência: <strong>cancelRecurring()</strong>
</li>
</ul><h4>
<a name="transaes-de-boleto" class="anchor" href="#transaes-de-boleto"><span class="mini-icon mini-icon-link"></span></a>Transações de Boleto</h4>

<ul>
<li>Criar boleto: <strong>boletoSale()</strong>
</li>
</ul><h4>
<a name="relatrios" class="anchor" href="#relatrios"><span class="mini-icon mini-icon-link"></span></a>Relatórios</h4>

<ul>
<li>Sondar uma transação: <strong>pullReport()</strong>
</li>
<li>Sondar uma lista de transações: <strong>pullReport()</strong>
</li>
<li>Paginar a lista de transações: <strong>pullReport()</strong> </li>
<li>Sondar um relatório pendente: <strong>pullReport()</strong>
</li>
</ul><h4>
<a name="cadastro-de-cliente--salvar-carto" class="anchor" href="#cadastro-de-cliente--salvar-carto"><span class="mini-icon mini-icon-link"></span></a>Cadastro de Cliente / Salvar Cartão</h4>

<ul>
<li>Criar um perfil: <em>(um perfil precisa ser criado antes de salvar um cartão)</em> <strong>addProfile()</strong>
</li>
<li>Atualizar um perfil: <strong>updateProfile()</strong> </li>
<li>Remover um perfil: <strong>deleteProfile()</strong>
</li>
<li>Adicionar um cartão de crédito: <strong>addCreditCard()</strong>
</li>
<li>Remover um cartão de crédito: <strong>deleteCreditCard()</strong>
</li>
</ul><h2 id="allres">Todas as respostas</h2>

<h4>
<a name="validao-da-chamada" class="anchor" href="#validao-da-chamada"><span class="mini-icon mini-icon-link"></span></a>Validação da chamada</h4>

<ul>
<li>Verifica se houve algum erro na chamada: <strong>isErrorResponse()</strong>
</li>
<li>Verificar se a chamada foi bem sucedida: <strong>isTransactionResponse()</strong>
</li>
</ul><h4>
<a name="principais-mthodos-de-resposta" class="anchor" href="#principais-mthodos-de-resposta"><span class="mini-icon mini-icon-link"></span></a>Principais métodos de resposta</h4>

<ul>
<li>Traz o Código de Autorização, se houver: <strong>getAuthCode()</strong>
</li>
<li>Traz o Order ID criado: <strong>getOrderID()</strong>
</li>
<li>Traz o Transaction ID criado: <strong>getTransactionID()</strong>
</li>
<li>Traz a URL do Boleto <em>(somente Brasil)</em>: <strong>getBoletoUrl()</strong>
</li>
<li>Traz o Código da Adquirente: <strong>getProcessorCode()</strong>
</li>
<li>Traz o Numero de Referência da Adquirente: <strong>getProcessorReferenceNumber()</strong>
</li>
<li>Traz o TID da Adquirente: <strong>getProcessorTransactionID()</strong>
</li>
<li>Traz todos os campos da resposta: <strong>getResponse()</strong>
</li>
</ul><h4>
<a name="outros-mtodos-de-rsposta" class="anchor" href="#outros-mtodos-de-rsposta"><span class="mini-icon mini-icon-link"></span></a>Outros métodos de rsposta</h4>

<ul>
<li>Traz a resposta do AVS <em>(somente EUA)</em>: <strong>getAvsResponseCode()</strong>
</li>
<li>Traz o Comando usado na chamada: <strong>getCommand()</strong>
</li>
<li>Traz o Customer ID criado: <strong>getCustomerId()</strong>
</li>
<li>Traz a resposta do CVV: <em>(somente EUA)</em> <strong>getCvvResponseCode()</strong>
</li>
<li>Traz o score da análise de fraude: <strong>getFraudScore()</strong>
</li>
<li>Traz a mensagem de resposta: <strong>getMessage()</strong>
</li>
<li>Traz o número de páginas do relatório: <strong>getNumberOfPages()</strong>
</li>
<li>Traz a página atual do relatório: <strong>getPageNumber()</strong>
</li>
<li>Traz o token da página do relatório: <strong>getPageToken()</strong>
</li>
<li>Traz um array com as transações listadas: <strong>getReportResult()</strong>
</li>
<li>Traz a data/hora do relatório: <strong>getTime()</strong>
</li>
<li>Traz o Token criado para o Cartão de Crédito: <strong>getToken()</strong>
</li>
<li>Traz o número de transações no relatório: <strong>getTotalNumberOfRecords()</strong>
</li>
<li>Traz o Unix time da transação: <strong>getTransactionTimestamp()</strong>
</li>
</ul><h2 id="support">Documentação e Suporte</h2>

<p><a href="http://www.maxipago.com/docs/maxiPago_API_Ultima.pdf">A documentação completa da API da <strong>maxiPago!</strong> pode ser encontrada aqui</a>.</p>

<p>Nossa equipe de suporte está à disposição para ajudá-lo com quaisquer assunto, seja sobre funcionalidades de nossa plataforma ou sobre pagamentos em geral. Eles estão disponíveis para clientes e não-clientes no endereço suporte [@] maxipago [.] com.</p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/maxipago">maxipago</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>